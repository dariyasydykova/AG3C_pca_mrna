source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
rmd_plot
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
setwd('Documents/GraduateSchool/Spring15/AG3C/')
read.csv('deseq_normalized_mrna_data.csv')
reads <- read.csv('deseq_normalized_mrna_data.csv')
View(reads)
glimpse(iris)
library(tidyr)
library(dplyr)
reads %>% scale() %>% prcomp() -> pca
reads <- read.csv('deseq_normalized_mrna_data.csv', row.names=TRUE)
reads %>% scale() %>% prcomp() -> pca
reads %>% prcomp() -> pca
reads %>% select(-x) %>% prcomp() -> pca
reads %>% select(-X) %>% prcomp() -> pca
pca
reads %>% select(-X) %>% scale() %>% prcomp() -> pca
pca
head(pca)
head(pca$x)
pca_data <- data.frame(pca$x, gene=reads$X)
head(pca_data)
ggplot(pca_data, aes(x=PC1, y=PC2, color=gene)) + geom_point()
library(ggplot)
library(ggplot2)
ggplot(pca_data, aes(x=PC1, y=PC2, color=gene)) + geom_point()
ggplot(pca_data, aes(x=PC1, y=PC2)) + geom_point()
reads %>% gather(sample, count)
reads %>% gather(X, sample, count) -> reads2
reads %>% gather(sample, count) -> reads2
View(reads2)
reads %>% gather(sample, count, -X) -> reads2
View(reads2)
metadata <- read.csv('sample_list.csv')
View(metadata)
metadata %>% rename(sample=Sample..) -> metadata
View(metadata)
metadata %>% transmutate(sample=paste('MURI_', sample))
metadata %>% mutate(sample2=paste('MURI_', sample))
metadata %>% mutate(sample2=paste('MURI_', sample)) -> metadata
View(metadata)
metadata <- read.csv('sample_list.csv')
View(metadata)
joined <- inner_join(reads2,metadata,by = c('sample'='Sample'))
View(joined)
joined <- rename(joined,gene=X)
View(joined)
joined2 <- spread(joined,gene)
joined2 <- spread(joined,gene,count)
View(joined2)
joined2 %>% filter(Growth.time > 24) -> joined3
glimpse(joined3)
View(joined3)
joined3 %>% select(-Experiment, -Batch, -Growth.Conditions, -Growth.time, -Harvest.Date, -Notes.NGS, -Cell_total, -cells_per_tube, -tubes_in_storage) -> joined4
View(joined4)
joined4 %>% scale() %>% prcomp() -> pca
joined4 %>% filter(-sample) %>% scale() %>% prcomp() -> pca
joined4 %>% filter(-sample) %>% prcomp() -> pca
View(reads2)
View(reads)
sum(is.na(joined4))
sum(is.na(reads))
reads3 <- t(reads)
View(reads3)
colnames(reads3) <- reads3[1,]
View(reads3)
reads3 <- reads3[2,]
reads3 <- t(reads)
colnames(reads3) <- reads3[1,]
reads3[-1,]
reads3 <- reads3[-1,]
View(reads3)
reads3 %>% filter(-row.names) %>% scale() %>% prcomp() -> pca
reads3 <- data.frame(t(reads))
View(reads3)
colnames(reads3) <- reads3[1,]
reads3 <- reads3[-1,]
reads3 %>% filter(-row.names) %>% scale() %>% prcomp() -> pca
View(reads3)
reads3 <- data.frame(t(reads))
View(reads3)
colnames(reads3) <- reads3[1,]
View(reads3)
reads3[1,]
colnames(reads3) <- reads3[1,]
View(reads3)
View(joined4)
joined4 %>% filter(-sample) %>% prcomp() -> pca
View(joined)
joined4 %>% filter(-sample) %>% prcomp() -> pca
warnings()
which(is.na(joined4))
joined2 <- spread(joined,gene,count,fill=0)
joined3 %>% select(-Experiment, -Batch, -Growth.Conditions, -Growth.time, -Harvest.Date, -Notes.NGS, -Cell_total, -cells_per_tube, -tubes_in_storage) -> joined4
joined4 %>% filter(-sample) %>% prcomp() -> pca
View(metadata)
joined4 %>% filter(-sample) %>% scale() %>% prcomp() -> pca
joined4 %>% filter(-sample) %>% as.numeric() %>% scale() %>% prcomp() -> pca
joined4 %>% filter(-sample) %>% as.numeric() -> pca_pre
joined4 %>% filter(-sample) -> pca_pre
View(pca_data)
View(pca_pre)
joined4 %>% select(-sample) %>% scale() %>% prcomp() -> pca
joined4 %>% select(-sample) %>% prcomp() -> pca
pca_data <- data.frame(pca$x, condition=joined3$Growth.Conditions)
ggplot(pca_data, aes(x=PC1, y=PC2, color=condition)) + geom_point()
joined2 %>% select(-Experiment, -Batch, -Growth.Conditions, -Growth.time, -Harvest.Date, -Notes.NGS, -Cell_total, -cells_per_tube, -tubes_in_storage) -> joined4
joined4 %>% select(-sample) %>% prcomp() -> pca
pca_data <- data.frame(pca$x, condition=joined2$Growth.Conditions)
ggplot(pca_data, aes(x=PC1, y=PC2, color=condition)) + geom_point()
savehistory("~/Documents/GraduateSchool/Spring15/AG3C/plot_history.Rhistory")
joined2 %>% filter(Growth.time > 4) -> joined3
joined3 %>% select(-Experiment, -Batch, -Growth.Conditions, -Growth.time, -Harvest.Date, -Notes.NGS, -Cell_total, -cells_per_tube, -tubes_in_storage) -> joined4
joined4 %>% select(-sample) %>% prcomp() -> pca
pca_data <- data.frame(pca$x, condition=joined3$Growth.Conditions)
ggplot(pca_data, aes(x=PC1, y=PC2, color=condition)) + geom_point()
